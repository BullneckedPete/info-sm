<div class="filterContainer">
  <div class="panel panel-info">
    <div class="panel-heading collapsed" data-toggle="collapse" data-target="#filterDates">
      <i class="fa fa-fw fa-chevron-down"></i>
      <i class="fa fa-fw fa-chevron-right"></i>{{ 'FILTER.FILTER_TIME' | translate }}
    </div>
    <div class="panel-body">
      <div id="filterDates" class="collapse " style="margin-bottom: 10px;">
        <fieldset>
          <!-- last week and last month disabled since we dont have this data at the moment -->
          <div class="radio radio--left">
            <label for="radio">
              <input type="radio" name="radios" class="radio" id="radio1" value="radio1" (click)="onChangeDate('week')"
                disabled>
              {{ 'FILTER.LASTWEEK' | translate }}
            </label>
          </div>
          <div class="radio radio--left">
            <label for="radio2">
              <input type="radio" name="radios" class="radio" id="radio2" value="radio2" (click)="onChangeDate('month')"
                disabled>
              {{ 'FILTER.LASTMONTH' | translate }}
            </label>
          </div>
          <div class="radio radio--left">
            <label for="radio3">
              <input type="radio" name="radios" class="radio" id="radio3" value="radio3" (click)="onChangeDate('year')"
                checked>
              {{ 'FILTER.LASTYEAR' | translate }}
            </label>
          </div>
          <div class="radio radio--left">
            <label for="radio4">
              <input type="radio" name="radios" class="radio" id="radio4" value="radio4"
                (click)="onChangeDate('threeYears')">
              {{ 'FILTER.LASTTHREEYEARS' | translate }}
            </label>
          </div>
          <div class="radio radio--left">
            <label for="radio5">
              <input type="radio" name="radios" class="radio" id="radio5" value="radio5"
                (click)="onChangeDate('whole')">
              {{ 'FILTER.WHOLETIME' | translate }}
            </label>
          </div>
        </fieldset>
        <div id="selectDateSection" class="notValid">
          <div class="input-group">
            <form class="form-inline">
              <div class="form-group">
                <div class="input-group-prepend">
                  <span class="input-group-text" id="inputGroup-sizing-default">{{ 'FILTER.FROM' | translate }}</span>
                </div>
                <div class="input-group" style="width: 40%">
                  <input class="form-control" placeholder="{{ 'EVAL.DATEPICKER_PLACEHOLDER' | translate }}" name="from" [(ngModel)]="from" ngbDatepicker
                    #fromPicker="ngbDatepicker">
                </div>
                <div class="input-group-append" style="height:33.5px;">
                  <button class="btn btn-outline-secondary calendar" (click)="fromPicker.toggle()" type="button"></button>
                </div>
              </div>
            </form>
            <form class="form-inline">
              <div class="form-group">
                <div class="input-group-prepend">
                  <span class="input-group-text" id="inputGroup-sizing-default">{{'FILTER.TO' | translate}}&nbsp;</span>
                </div>
                <div class="input-group" style="width: 40%">
                  <input class="form-control" placeholder="{{ 'EVAL.DATEPICKER_PLACEHOLDER' | translate }}" name="to" [(ngModel)]="to" ngbDatepicker #toPicker="ngbDatepicker">
                </div>
                <div class="input-group-append" style="height:33.5px;">
                  <button class="btn btn-outline-secondary calendar" (click)="toPicker.toggle()" type="button"></button>
                </div>
              </div>
            </form>
            <button style="height:35px; margin-top: 15px" class="btn btn-dark" type="submit"
              (click)="onGetFromToDates(from, to)">{{'FILTER.FILTER_ACTION' | translate}}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="panel panel-info">
    <div class="panel-heading collapsed" data-toggle="collapse" data-target="#filterCategories">
      <i class="fa fa-fw fa-chevron-down"></i>
      <i class="fa fa-fw fa-chevron-right"></i>{{'FILTER.FILTER_BY_CATEGORY' | translate}}
    </div>
    <div class="panel-body">
      <div id="filterCategories" class="collapse" style="margin-top: 10px">
        <div class="flex-container">
          <!-- cantons and communities -->
          <div class="select-wrapper">
            <label class="selction-label" for="cantons">{{ 'FILTER.FILTER_CANTONS' | translate }}</label>
            <ng-select [items]="cantons" notFoundText="{{'FILTER.NO_ENTRIES' | translate}}" [multiple]="true"
              name="cantons" placeholder="{{'FILTER.PLACEHOLDER_CANTON' | translate}}" (add)="onAdd($event, 'canton')"
              (remove)="onRemove($event, 'canton')" (clear)="onClear($event, 'canton')">
            </ng-select>
          </div>
          <div class="select-wrapper">
            <label class="selction-label" for="communities">{{ 'FILTER.FILTER_MUNICS' | translate }}</label>
            <ng-select [items]="communities" notFoundText="{{'FILTER.NO_ENTRIES' | translate}}" [multiple]="true"
              name="communities" placeholder="{{'FILTER.PLACEHOLDER_MUNICIPALITY' | translate}}"
              (add)="onAdd($event, 'munic')" (remove)="onRemove($event, 'munic')"
              (clear)="onClear($event, 'munic')">
            </ng-select>
          </div>
          <!--        epidamic groups and epidemics-->
          <div class="select-wrapper">
            <label class="selction-label" for="epidemic_groups">{{ 'FILTER.FILTER_PEST_GROUPS' | translate }}</label>
            <ng-select [items]="epidemics_group" notFoundText="{{'FILTER.NO_ENTRIES' | translate}}" [multiple]="true"
              name="epidamic_groups" placeholder="{{'FILTER.PLACEHOLDER_EPIDEMIC_GROUP' | translate}}"
              (add)="onAdd($event, 'epidemic_group')" (remove)="onRemove($event, 'epidemic_group')"
              (clear)="onClear($event, 'epidemic_group')">
            </ng-select>
          </div>
          <div class="select-wrapper">
            <label class="selction-label" for="epidemics">{{ 'FILTER.FILTER_PESTS' | translate }}</label>
            <ng-select [items]="epidemics" notFoundText="{{'FILTER.NO_ENTRIES' | translate}}" [multiple]="true"
              name="epidemics" placeholder="{{'FILTER.PLACEHOLDER_EPIDEMIC' | translate}}"
              (add)="onAdd($event, 'epidemic')" (remove)="onRemove($event, 'epidemic')"
              (clear)="onClear($event, 'epidemic')">
            </ng-select>
          </div>
          <!-- animal groups and animal species  -->
          <div class="select-wrapper">
            <label class="selction-label" for="animal_groups">{{ 'FILTER.FILTER_ANIMAL_GROUPS' | translate }}</label>
            <ng-select [items]="animal_group" notFoundText="{{'FILTER.NO_ENTRIES' | translate}}" [multiple]="true"
              name="animal_groups" placeholder="{{'FILTER.PLACEHOLDER_ANIMAL_GROUP' | translate}}"
              (add)="onAdd($event, 'animal_group')" (remove)="onRemove($event, 'animal_group')"
              (clear)="onClear($event, 'animal_group')">
            </ng-select>
          </div>
          <div class="select-wrapper">
            <label class="selction-label" for="animals">{{ 'FILTER.FILTER_ANIMALS' | translate }}</label>
            <ng-select [items]="animal_species" notFoundText="{{'FILTER.NO_ENTRIES' | translate}}" [multiple]="true"
              name="animals" placeholder="{{'FILTER.PLACEHOLDER_ANIMAL_SPECIES' | translate}}"
              (add)="onAdd($event, 'animal_species')" (remove)="onRemove($event, 'animal_species')"
              (clear)="onClear($event, 'animal_species')">
            </ng-select>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<div style="margin-top: 15px; width:100%" class="row">
  <div class="col-sm-10 col-sm-offset-1">
    <ul class="nav nav-tabs">
      <li id="frequency">
        <a data-toggle="tab" (click)="onChangeTab('/frequency')">{{ 'FILTERCHARTS.FREQUENCY' | translate }}
        </a>
      </li>
      <li id="timeline">
        <a data-toggle="tab" (click)="onChangeTab('/timeline')">{{ 'FILTERCHARTS.TIMELINE' | translate }}
        </a>
      </li>
      <li id="map">
        <a data-toggle="tab" (click)="onChangeTab('/map')">{{ 'FILTERCHARTS.MAP' | translate }}
        </a>
      </li>
    </ul>
    <router-outlet></router-outlet>
  </div>
</div>

<ng-template #loadingList>
  <div class="loadingSign">
    <fa name="refresh" size="4x" animation="spin"></fa>
  </div>
</ng-template>

<div class="table">
  <p *ngIf="sorted">{{ 'EVAL.VISU_DATA' | translate }} <i>{{ sortDirection }}</i> {{ 'EVAL.ORDER_BY' | translate }}: <i>{{ sortItem }}</i></p>
  <p *ngIf="!sorted">{{  'EVAL.NOT_SORTED' | translate }}</p>
<div class="mat-elevation-z8" style="margin:5% 5%; margin-top:1%">
  <mat-table class="mat-elevation-z8" [dataSource]="dataSource" matSort (matSortChange)="getSortItemAndOrder($event)">
    <ng-container matColumnDef="diagnosis_date">
      <mat-header-cell *matHeaderCellDef mat-sort-header><strong>{{ 'EVAL.DIAGNOSIS_DATE' | translate }}
        </strong></mat-header-cell>
      <mat-cell *matCellDef="let element"> {{element.diagnosis_date | chDate }} </mat-cell>
    </ng-container>

    <ng-container matColumnDef="canton">
      <mat-header-cell *matHeaderCellDef mat-sort-header><strong>{{ 'EVAL.CANTON' | translate }}</strong>
      </mat-header-cell>
      <mat-cell *matCellDef="let element">{{element.canton}} </mat-cell>
    </ng-container>

    <ng-container matColumnDef="munic">
      <mat-header-cell *matHeaderCellDef mat-sort-header>
        <strong>{{ 'EVAL.MUNICIPALITY' | translate }}</strong></mat-header-cell>
      <mat-cell *matCellDef="let element"> {{element.munic}} </mat-cell>
    </ng-container>


    <ng-container matColumnDef="epidemic_group">
      <mat-header-cell *matHeaderCellDef mat-sort-header><strong>{{ 'EVAL.PEST_GROUP' | translate }}
        </strong></mat-header-cell>
      <mat-cell *matCellDef="let element"> {{element.epidemic_group}} </mat-cell>
    </ng-container>


    <ng-container matColumnDef="epidemic">
      <mat-header-cell *matHeaderCellDef mat-sort-header><strong>{{ 'EVAL.PEST' | translate }}</strong>
      </mat-header-cell>
      <mat-cell *matCellDef="let element"> {{element.epidemic}} </mat-cell>
    </ng-container>

    <ng-container matColumnDef="animal_species">
      <mat-header-cell *matHeaderCellDef mat-sort-header>
        <strong>{{ 'EVAL.ANIMAL_SPECIES' | translate }}</strong>
      </mat-header-cell>
      <mat-cell *matCellDef="let element"> {{element.animal_species}}</mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
    <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
  </mat-table>

  <mat-paginator [pageSize]="5" [hidePageSize]="true" showFirstLastButtons></mat-paginator>
</div>
</div>